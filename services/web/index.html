<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generación de efectos olvidados</title>
  <link rel="stylesheet" href="/app/styles.css" />
  <script src="https://unpkg.com/vis-network@9.1.6/dist/vis-network.min.js"></script>
</head>
<body>
  <header>
    <h1>Generación de efectos olvidados</h1>
    <p>Ingiere el tensor original, ajusta los parámetros y visualiza los caminos hallados por orden.</p>
  </header>

  <main>
    <section class="card">
      <h2>Configuración</h2>
      <form id="effects-form">
        <div class="field">
          <label for="tensor">Tensor original (JSON con forma [batch, M, N])</label>
          <textarea id="tensor" name="tensor" rows="8" spellcheck="false"></textarea>
          <small>Puedes pegar una matriz en formato JSON. El valor por defecto carga un ejemplo 2x2x3.</small>
        </div>
        <div class="group">
          <div class="field">
            <label for="threshold">Threshold</label>
            <input type="number" id="threshold" name="threshold" min="0" max="1" step="0.01" value="0.3" required />
          </div>
          <div class="field">
            <label for="order">Orden máximo</label>
            <input type="number" id="order" name="order" min="2" max="10" value="4" required />
          </div>
          <div class="field">
            <label for="bootstrap">Replicas bootstrap</label>
            <input type="number" id="bootstrap" name="bootstrap" min="0" value="0" />
            <small>Usa 0 para desactivar.</small>
          </div>
        </div>
        <div class="field">
          <label for="backend-url">URL del servicio (opcional)</label>
          <input type="url" id="backend-url" name="backend-url" placeholder="http://localhost:8000/effects" />
          <small>Deja vacío para usar solo los datos de ejemplo.</small>
        </div>
        <div class="actions">
          <button type="submit" id="submit-btn">Generar efectos</button>
          <button type="button" id="use-sample">Ver ejemplo sin servicio</button>
        </div>
      </form>
      <div id="status" role="status"></div>
    </section>

    <section id="results" class="card hidden">
      <h2>Resultados</h2>
      <div id="summary"></div>
      <div id="graph-tabs"></div>
      <div id="graphs-container"></div>
      <div id="tables-container"></div>
      <div id="dictionary-container" class="card nested hidden">
        <h3>Diccionario de efectos (origen → destino)</h3>
        <div id="dictionary-table-wrapper"></div>
      </div>
    </section>
  </main>

  <footer>
    <p>API servida por <code>/effects</code>. Usa <code>uvicorn services.effects_api:app</code> para levantar el servicio.</p>
  </footer>

  <script type="module" src="/app/app.js"></script>
</body>
</html>
